{% extends 'main/layout.html' %}

{% block title %} Клиенты {% endblock %}
{% block content %}
    
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        
        <div class="col-9">
          <div class="card pl-5">
            <h2 class="pt-3 pb-3 m-4">Clients</h2>
            <table class="table table-dark table-hover text-truncate " style="font-size: 14px">
                <thead>
                  <tr class="text-secondary"> 
                    <td scope="col" class="font-weight-normal text-secondary"></th>
                    <td scope="col" class="text-secondary font-weight-normal">#</th>
                    <td scope="col" class="font-weight-normal text-secondary">Name</th>
                    <td scope="col" class="font-weight-normal text-secondary">Contact</th>
                    <td scope="col" class="font-weight-normal text-secondary">Telegram</th>
                    <td scope="col" class="font-weight-normal text-secondary">Phone</th>
                    <td scope="col" class="font-weight-normal text-secondary">Roletype</th>
                    <td scope="col" class="font-weight-normal text-secondary">Last Project</th>
                    <td scope="col" class="font-weight-normal text-secondary">Agreements</th>
                    <td scope="col" class="font-weight-normal text-secondary">Status</th>
                  </tr>
                </thead>
                <tbody class="font-weight-light">
                {% if clients %}
                  {% for client in clients %}
                    <tr>
                    <td> </td>
                    <td class="text-secondary">
                      {% if not client.id %}
                        <p class="text-secondary"> - </p>
                      {% else %}
                        {{client.id}}
                      {% endif %}
                    </td>
                    <td>
                      {% if not client.client_name %}
                        <p class="text-secondary"> - </p>
                      {% else %}
                      <a href="{{ client.get_absolute_url }}">{{client.client_name}}</a>
                    {% endif %} </td>
                    <td>
                      {% if not client.client_contact %}
                        <p class="text-secondary"> - </p>
                      {% else %}
                      {{client.client_contact}}
                    {% endif %} </td>
                    <td>{% if not client.client_telegram %}
                      <p class="text-secondary"> - </p>
                    {% else %}{{client.client_telegram}}{% endif %}</td>
                    <td>{% if not client.client_phone %}
                      <p class="text-secondary"> - </p>
                    {% else %}{{client.client_phone}}{% endif %}</td>
                    <td>{% if not client.client_roletype %}
                      <p class="text-secondary"> - </p>
                    {% else %}{{client.client_roletype}}{% endif %}</td>
                    <td>
                      {% if not client.project.all %}
                        <p class='text-secondary'> No projects </p>
                      {% else %}
                      {% with client.project.all.last as project %}
                          <a href="#">{{ project.project_name }}</a>
                        {% endwith %} 
                      {% endif %}
                    </td>
                    <td>{% if not client.project.all %}
                      <p class='text-secondary'> – </p>
                    {% else %}<a href="#">{{client.client_agreements}}</a>{% endif %}</td>
                    <td>
                      {% if client.client_active == True %}
                      <p class="text-primary"> Активен </p>
                      {% else %}
                      <p class="text-secondary"> Не активен</p>
                      {% endif %}
                    </td>
                  </tr>
                  {% endfor %}
                {% else %}
                    <tr>
                        <th scope="row"></th>
                        <td>No clients yet</td>
                  </tr>
                {% endif %}
                </tbody>
              </table>
            </div>
          </div>
      
        
          {% comment %} Form {% endcomment %}
          <div class="col-3" style="">
            <div class="card p-3" style="">
              <h2 class="mx-auto pb-3 pt-3 m-4">Add client</h2>
              <div class="form-group mx-auto" style="">    
              <form action="{% url 'clients_page' %}" method="post"> 
                    {% csrf_token %}
                    {% for f in clientform %}
                    <div class="pb-4">
                      {% comment %} <label class="form-label" for="{{ f.id_for_label }}">{{f.label}}: </label> {% endcomment %}
                      {{ f }}</div>
                    <div class="form-error">{{ clientform.f.errors }}</div>
                    {% endfor %}
                    <button type="submit" class="btn btn-primary mt-4 mb-4 container-fluid" style="">Add</button>
              </form>
              <br/>
              <p class="mx-auto text-secondary" style="font-size: 12px">* - Обязательное поле</p>
              </div>
          </div>
        </div>
    <br>
</div>
{% endblock %}